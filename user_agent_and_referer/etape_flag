Flag : f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188

Vulnérabilité exploitée

Confiance excessive dans les en-têtes HTTP (User-Agent et Referer).

L’application vérifie uniquement la présence de certains headers HTTP pour autoriser l’accès à une page cachée et afficher le flag, ce qui est une mauvaise pratique de sécurité.

Étapes de découverte

Découverte d’une page cachée via le paramètre page

En inspectant le code source de index.php, un lien suspect est présent :

?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f


L’accès direct à cette page affiche du contenu mais pas le flag.

Analyse du code HTML retourné

Plusieurs commentaires HTML indiquent des conditions :

You must come from : "https://www.nsa.gov/"
Let's use this browser : "ft_bornToSec"


Ces commentaires suggèrent une vérification côté serveur du Referer et du User-Agent.

Forçage des headers HTTP

Une requête HTTP personnalisée est envoyée en modifiant les en-têtes requis.

Commande utilisée
curl -i \
  -H "Referer: https://www.nsa.gov/" \
  -H "User-Agent: ft_bornToSec" \
  "http://192.168.133.142//index.php?page=b7e44c7a40c5f80139f0a50f3650fb2bd8d00b0d24667c4c2ca32c88e13b758f"

Résultat obtenu

Le serveur retourne la page avec le message :

The flag is : f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188


Le flag est affiché uniquement lorsque les headers attendus sont présents.

Correctif recommandé

Ne jamais utiliser User-Agent ou Referer comme mécanisme de contrôle d’accès.

Mettre en place une authentification réelle (session, token, rôle).

Supprimer les informations sensibles dans les commentaires HTML.
