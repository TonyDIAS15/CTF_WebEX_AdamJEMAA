Flag

f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188

Technique utilisée

sql_injection_union_searchimg

Vulnérabilité exploitée

La page searchimg utilise directement la valeur du paramètre id dans une requête SQL sans validation ni requête préparée.
Cela permet l’injection de requêtes SQL arbitraires via des clauses UNION ALL SELECT.

La logique applicative exécute bien la requête SQL lorsque le paramètre Submit est présent, mais n’affiche pas directement les résultats dans l’interface graphique. Les données sont néanmoins exploitables via l’injection SQL.

Il s’agit d’une SQL Injection UNION-based.

Étapes de découverte et d’exploitation
Identification du point d’entrée

Depuis la page principale, un bouton permet d’accéder à la fonctionnalité de recherche d’images :

index.php?page=searchimg


Le formulaire transmet les paramètres suivants :

id

Submit

Confirmation de la présence d’une base de données

Des tests SQL montrent que l’entrée id est interprétée par le moteur SQL.
La base de données et la version du SGBD sont identifiées :

Base : Member_images

SGBD : MariaDB 5.5.64

Énumération des tables

L’injection permet de lister les tables de la base courante via information_schema.tables.

Table identifiée :

list_images

Énumération des colonnes

L’analyse de information_schema.columns permet d’identifier la structure de la table :

id, url, title, comment

Extraction des données

Les données de la table list_images sont extraites.
La colonne comment contient une indication explicite menant au flag :

If you read this just use this md5 decode lowercase then sha256 to win this flag !
: 1928e8083cf461a51303633093573c46

Traitement du flag

Décodage MD5

1928e8083cf461a51303633093573c46 → albatroz


Conversion en minuscules

albatroz


Calcul du hash SHA256

echo -n "albatroz" | sha256sum


Résultat :

f2a29020ef3132e01dd61df97fd33ec8d7fcd1388cc9601e7db691d17d4d6188

Résultat obtenu

L’exploitation de la SQL Injection permet :

l’énumération complète de la base de données,

l’extraction des données de la table list_images,

l’obtention d’une valeur chiffrée menant au flag après transformation cryptographique.

Impact

Accès non autorisé à la base de données

Exfiltration de données sensibles

Possibilité de modification ou suppression de données

Compromission complète de l’intégrité applicative

Correctif recommandé

Utiliser des requêtes préparées (PDO / MySQLi avec bind parameters)

Valider strictement les entrées utilisateur (type numérique pour id)

Désactiver l’accès à information_schema si non nécessaire

Ne jamais concaténer des entrées utilisateur dans des requêtes SQL

Mettre en place une gestion d’erreurs côté serveur sans exposition logique
